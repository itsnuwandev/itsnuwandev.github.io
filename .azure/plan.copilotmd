# Azure Deployment Plan for NuwanB Portfolio Project

## **Goal**

Deploy a React/TypeScript portfolio application to Azure using Azure Developer CLI (AZD) with Azure App Service hosting.

## **Project Information**

**NuwanB Portfolio**

- **Stack**: React 18 + TypeScript + Vite + Tailwind CSS + Shadcn/UI
- **Type**: Personal portfolio website with interactive UI components
- **Build Tool**: Vite with SWC for fast builds
- **Dependencies**: No backend dependencies - purely static frontend
- **Hosting**: Azure App Service (Static Web App alternative)
- **Features**: Contact forms, animated components, responsive design

## **Azure Resources Architecture**

```mermaid
graph TB
    User[User] --> AppService[Azure App Service]
    AppService --> Storage[Azure Storage Account]
    AppService --> Insights[Application Insights]
    AppService --> KeyVault[Azure Key Vault]
    Identity[User-Assigned Managed Identity] --> KeyVault
    Identity --> AppService
    Insights --> LogAnalytics[Log Analytics Workspace]
```

**Resource Relations:**

- The App Service hosts the built React application as a static site
- Application Insights monitors application performance and user interactions
- User-Assigned Managed Identity provides secure access to Key Vault
- Log Analytics Workspace centralizes logging and monitoring data

## **Recommended Azure Resources**

**Application: NuwanB Portfolio**

- **Hosting Service Type**: Azure App Service
- **SKU**: B1 (Basic) - 1 Core, 1.75 GB RAM, suitable for personal portfolio with moderate traffic
- **Configuration**:
  - **Language**: Node.js 18 LTS
  - **Environment Variables**:
    - `WEBSITE_NODE_DEFAULT_VERSION: "18-lts"`
    - `SCM_DO_BUILD_DURING_DEPLOYMENT: "true"`

## **Recommended Supporting Services**:

- **Application Insights**: Standard tier for performance monitoring and analytics
- **User-Assigned Managed Identity**: For secure service-to-service authentication
- **Log Analytics Workspace**: Centralized logging for all app service logs
- **Key Vault** (Optional): For storing any future API keys or sensitive configuration

## **Recommended Security Configurations**:

- User-Assigned Managed Identity must have Key Vault Secrets User permissions
- User-Assigned Managed Identity must be assigned to the App Service
- HTTPS only enforcement enabled on App Service
- Minimum TLS version set to 1.2

## **Execution Steps**

> **Below are the steps for Copilot to follow; ask Copilot to update or execute this plan. Add check list for the steps.**

**Execution Steps:**

### 1. Provision Azure Infrastructure with AZD:

- [ ] **Provisioning tool**: AZD. Expected files: `azure.yaml`, `infra/main.bicep`, `infra/main.parameters.json`
- [ ] Get current subscription ID and check regional availability using `appmod-get-regions-with-sufficient-quota`
- [ ] **Generate missing expected files** (none exist currently):
  - [ ] Call `appmod-get-iac-rules` to get bicep generation rules
  - [ ] Generate `azure.yaml` for AZD configuration
  - [ ] Generate `infra/main.bicep` for Azure resources
  - [ ] Generate `infra/main.parameters.json` for configuration
  - [ ] Use `get_errors` on generated files and fix any issues
- [ ] Run `azd provision --preview --no-prompt` for infrastructure dry run
- [ ] Fix any bicep errors and retry provisioning

### 2. Environment Setup for AZD:

- [ ] Install AZ CLI and AZD if not already installed
- [ ] Run `azd env new portfolio-env --no-prompt` to create new environment
- [ ] Set required environment variables:
  - [ ] `AZURE_SUBSCRIPTION_ID` (use default subscription)
  - [ ] `AZURE_LOCATION` (based on quota availability)
  - [ ] `AZURE_RESOURCE_GROUP` (auto-generated or user-specified)
- [ ] Verify resource group exists or will be created

### 3. Deployment:

- [ ] **Build the React Application**:
  - [ ] Run `npm run build` to create production build
  - [ ] Verify `dist/` folder contains built assets
- [ ] **AZD App Deployment**:
  - [ ] Run `azd up --no-prompt` for full deployment
  - [ ] Monitor deployment progress and fix any errors
  - [ ] If region issues occur, run `azd down --force --no-prompt` and retry
- [ ] **Deployment Validation**:
  - [ ] Use `appmod-get-azd-app-logs` to check application logs
  - [ ] Verify website is accessible and functioning correctly

### 4. Summarize Deployment Result:

- [ ] Use `appmod-summarize-result` tool to create deployment summary
- [ ] Generate final documentation in `.azure/summary.copilotmd`

## **Progress Tracking**

Progress will be tracked in `.azure/progress.copilotmd` with:

- ‚úÖ Completed tasks
- üî≤ Pending tasks
- ‚ùå Failed tasks with error notes and retry information

**Example format:**

- [x] Project analysis complete (React/Vite detected)
- [x] Deployment plan generated
- [ ] Infrastructure files generation in progress
- [ ] AZD environment setup pending
- [ ] Deployment pending
